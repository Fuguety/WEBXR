  <!doctype html>
  <html lang="en">
    <head>

      <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>

      <script src="https://cdn.jsdelivr.net/npm/aframe-simple-sun-sky@^1.2.2/simple-sun-sky.js"></script>
      <script src="https://unpkg.com/@c-frame/aframe-particle-system-component@1.2.x/dist/aframe-particle-system-component.min.js"></script>

      <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.6.0/dist/aframe-extras.min.js"></script>
      <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-physics-system@v4.2.3/dist/aframe-physics-system.min.js"></script>


    <script>

        AFRAME.registerComponent('player-controls', 
            {
            init: function () {
            const el = this.el;
            const velocity = new THREE.Vector3();
            let isSprinting = false;
            let canJump = true;

              window.addEventListener('keydown', e => 
              {
                if (e.code === 'ShiftLeft')
                  {
                    isSprinting = true;
                    el.setAttribute('movement-controls', 'speed', 2);
                  }

                if (e.code === 'Space' && canJump)
                  
                {
                  canJump = false;
                  const startPos = el.getAttribute('position');
                  const jumpHeight = 3;

                  // go up
                  el.setAttribute('animation__jumpup', 
                  {
                      property: 'position',
                      to: `${startPos.x} ${startPos.y + jumpHeight} ${startPos.z}`,
                      dur: 300,
                      easing: 'easeOutQuad',
                      dir: 'alternate',
                      loop: 1
                  });

                  // cooldown
                  setTimeout(() => canJump = true, 600);
                  
                }

              });




            
            window.addEventListener('keyup', e => 
              {
                if (e.code === 'ShiftLeft') isSprinting = false;
              });

            el.addEventListener('componentchanged', evt => {
              if (evt.detail.name === 'movement-controls') 
              {
                // Adjust speed dynamically
                const speed = isSprinting ? 1 : 0.8;
                el.setAttribute('movement-controls', 'speed', speed);
              }
            });
          }

        });


      </script>



      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="icon" type="image/svg+xml" href="/vite.svg" />

      <title>Vite + TS</title>
    
    </head>
    
    <body>

      <a-scene renderer="antialias: true;
                        colorManagement: true
                        sortTransparentObjects: true"
              stats
              fog="type: linear; color: white; near: 1; far: 1000"
              physics="debug: true" xr-mode-ui="enabled: true; enterAREnabled: true; XRMode: ar;"
              >

          <a-assets>

              <img id="ground" crossorigin="anonymous" 
                  src="ground.jpg"></img>

              <img id="checker" crossorigin="anonymous"
                  src="https://thumbs.dreamstime.com/b/marble-checkerboard-floor-24539536.jpg">          
                  
              <img id="error" crossorigin="anonymous"
                  src="https://i.imgur.com/5NZ6T4X.png">

              <img id="grid" crossorigin="anonymous"
                  src="https://i.redd.it/godot-theme-prototype-textures-v0-pev67seeqtac1.png?width=512&format=png&auto=webp&s=93a766784649116e0ad867af9c42ed7c2118ae2e">

          </a-assets>

          
        <!-- Ground Plane -->
        <a-plane width="25" height="25"
                rotation="-90 0 0"
                material="src: #checker; repeat: 10 10; side: double"
                static-body
                >
        </a-plane>

          <!-- falling material -->
        <a-box position="0 5 -3" width="1" height="1" depth="1"
            material="src: #grid; side: double" 
            dynamic-body>
        </a-box>
         
        <a-cone position="0 7 -3" radius="0.5" height="1" 
              rotation="-90 0 0"
              material="src: #grid; side: double" 
              dynamic-body>
        </a-cone>



        <!-- WASD + physics body -->
        <a-entity id="player"
                  movement-controls="speed: 0.8"
                  player-controls
                  position="0 1.6 0"
                  kinematic-body="radius: 0.3; height: 1.6">
          <a-entity camera look-controls></a-entity>
        </a-entity>

        


        <!-- rain -->
        <a-entity id="rain" particle-system="preset: snow; color: #24CAFF; particleCount: 5000"></a-entity>

        <!-- Sun -->
        <a-simple-sun-sky sun-position="5 7 -5"></a-simple-sun-sky>
        <a-light id="dirlight" intensity="1" light="castShadow:true;type:directional" position="0 1 -5"></a-light>



        <a-entity id="light" light="type: ambient; color: #888"></a-entity>



        <!-- shadows -->
        <a-entity light="type:directional; castShadow:true;" position="1 1 1"></a-entity>
        <a-gltf-model src="tree.gltf" shadow="receive: false"></a-gltf-model>






        <!-- Ocean -->
        <a-entity id="ocean" ocean="density: 10; width: 25; depth: 25; speed: 4"
          material="color: #9CE3F9; opacity: 0.75; metalness: 0; roughness: 1 shader:ocean"
          position="0 0 -24"
          rotation="-90 0 0"></a-entity>

        



        <!-- Test entity 1 -->


        <a-entity id="test" geometry="primitive: box; width: 2; height: 1; depth: 1;"
          material="color: yellow; metalness: 1; roughness: 0.5;"
          position="0 0.15 -20"
          light="type: point; intensity: 5"
          animation="property: position; easing: easeInOutQuad; dir: alternate; dur: 1000; to: 0 -0.10 -20; loop: true"
          rotation="75 5 40"
          >

        <a-text value="$90,312.23"
          position="0 2 0"
          color="red"
          align="center"
          side="double"></a-text>

        </a-entity>



        <!-- Test entity 2 -->
        <a-entity id="test2" geometry="primitive: sphere; radius: 1.8;"
          material="color: red; metalness: 1; roughness: 0.5;"
          position="4 -0.15 -20"
          animation="property: position; easing: easeInOutQuad; dir: alternate; dur: 1000; to: 4 0.10 -20; loop: true"
          >
          <a-text value="undefined"
          position="0 2 0"
          color="black"
          align="center"
          side="double"></a-text>
        </a-entity>



        <!-- Test entity 3  Moving Box-->
        <a-box
          position="-10 1 -10"
          width="1" height="1" depth="1"
          material="src: #error; side: double"
          animation="property: position; to: 10 1 -10; dur: 3000; easing: linear; dir: alternate; loop: true"
          >
          <a-text value="Moving Box" align="center" position="0 1 0" side="double"></a-text>
        </a-box>



      </a-scene>

    </body>


  </html>
